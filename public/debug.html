<!DOCTYPE html>
<html>
<head>
    <title>Debug de Produtos</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #0f0; }
        .output { background: #000; padding: 15px; border-radius: 5px; margin: 10px 0; max-height: 600px; overflow-y: auto; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; background: #0f0; color: #000; border: none; border-radius: 3px; }
        .error { color: #f00; }
        .success { color: #0f0; }
        .info { color: #0ff; }
    </style>
</head>
<body>

<h1>ğŸ”§ Debug - Teste de Produtos</h1>

<button onclick="testFetch()">ğŸ“¡ Testar Fetch /api/products</button>
<button onclick="testRender()">ğŸ¨ Testar RenderizaÃ§Ã£o</button>
<button onclick="checkHTML()">ğŸ“„ Verificar HTML</button>
<button onclick="location.reload()">ğŸ”„ Recarregar PÃ¡gina</button>

<div class="output" id="log"></div>

<script>
const log = document.getElementById('log');

function write(msg, type = 'info') {
    const span = document.createElement('div');
    span.className = type;
    span.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
    log.appendChild(span);
    log.scrollTop = log.scrollHeight;
    console.log(msg);
}

async function testFetch() {
    write('ğŸš€ Iniciando teste de fetch...', 'info');
    try {
        write('ğŸ“¡ Conectando em http://localhost:3333/api/products...', 'info');
        const resp = await fetch('http://localhost:3333/api/products');
        write(`HTTP Status: ${resp.status}`, resp.ok ? 'success' : 'error');
        
        const data = await resp.json();
        write(`âœ… Resposta recebida: ${JSON.stringify(data).length} bytes`, 'success');
        write(`ğŸ“¦ Total de produtos: ${data.length}`, 'success');
        
        if (data.length > 0) {
            data.slice(0, 3).forEach((p, i) => {
                write(`${i + 1}. ${p.name} - R$ ${p.priceCurrent} (${p.active ? 'ATIVO' : 'INATIVO'})`, 'success');
            });
        } else {
            write('âš ï¸  NENHUM PRODUTO NO BANCO!', 'error');
        }
    } catch (e) {
        write(`âŒ ERRO: ${e.message}`, 'error');
    }
}

function testRender() {
    write('ğŸ¨ Testando renderizaÃ§Ã£o...', 'info');
    const grid = document.querySelector('.products-grid');
    if (!grid) {
        write('âŒ .products-grid NÃƒO ENCONTRADO NO HTML!', 'error');
        return;
    }
    write(`âœ… .products-grid encontrado`, 'success');
    write(`ConteÃºdo atual: ${grid.children.length} elementos filhos`, 'info');
    write(`HTML: ${grid.innerHTML.substring(0, 100)}...`, 'info');
}

function checkHTML() {
    write('ğŸ“„ Verificando estrutura HTML...', 'info');
    const checks = [
        ['.products-grid', 'Grid de produtos'],
        ['script[src="js/products.js"]', 'Script products.js'],
        ['script[src="js/notifications.js"]', 'Script notifications.js'],
        ['.product-section', 'SeÃ§Ã£o de produtos']
    ];
    
    checks.forEach(([selector, name]) => {
        const exists = document.querySelector(selector);
        write(`${exists ? 'âœ…' : 'âŒ'} ${name}`, exists ? 'success' : 'error');
    });
}

write('âœ… PÃ¡gina de debug carregada', 'success');
</script>

</body>
</html>
