<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciar Produtos - Admin</title>
    <link rel="stylesheet" href="/admin/admin-modern.css">
</head>
<body class="admin-body">

    <!-- SIDEBAR ADMIN -->
    <aside class="admin-sidebar">
        <div class="sidebar-header">
            <h2>üõí Admin Panel</h2>
            <p>Pretinho Variedades</p>
        </div>

        <nav class="sidebar-nav">
            <ul>
                <li><a href="/admin/index.html">üè† In√≠cio</a></li>
                <li><a href="/admin/produtos.html" class="active">üì¶ Produtos</a></li>
                <li><a href="/admin/pedidos.html">üõçÔ∏è Pedidos</a></li>
                <li><a href="/" target="_blank">üåê Ver Site</a></li>
            </ul>
        </nav>

        <div class="sidebar-footer">
            <button id="logoutBtn" class="btn-logout">üö™ Sair</button>
        </div>
    </aside>

    <!-- CONTE√öDO PRINCIPAL -->
    <main class="admin-main">
        <!-- TOPBAR -->
        <header class="admin-topbar">
            <div class="topbar-left">
                <h1>Gerenciar Produtos</h1>
            </div>
            <div class="topbar-right">
                <button id="btnAddProduct" class="btn-primary">‚ûï Novo Produto</button>
            </div>
        </header>

        <!-- CONTE√öDO -->
        <div class="admin-content">
            <!-- FILTROS E BUSCA -->
            <div class="filters-bar">
                <div class="search-group">
                    <input type="text" id="searchProduct" placeholder="üîç Buscar produto...">
                </div>
                <div class="filter-group">
                    <select id="filterCategory">
                        <option value="">Todas as Categorias</option>
                        <option value="mochilas">Mochilas</option>
                        <option value="canetas">Canetas</option>
                        <option value="cadernos">Cadernos</option>
                        <option value="estojos">Estojos</option>
                    </select>
                </div>
            </div>

            <!-- TABELA DE PRODUTOS -->
            <div class="table-container">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Imagem</th>
                            <th>Nome</th>
                            <th>Categoria</th>
                            <th>Pre√ßo Original</th>
                            <th>Pre√ßo Oferta</th>
                            <th>Desconto</th>
                            <th>Status</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <!-- Produtos ser√£o carregados via JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- MODAL ADICIONAR/EDITAR PRODUTO -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Adicionar Produto</h2>
                <button class="modal-close">&times;</button>
            </div>

            <div class="product-form">
                <!-- N√£o √© mais um <form>, apenas uma div! -->
                <input type="hidden" id="productId">

                <div class="form-row">
                    <div class="form-group">
                        <label for="productName">Nome do Produto *</label>
                        <input type="text" id="productName" required placeholder="Ex: Mochila Escolar Grande">
                    </div>

                    <div class="form-group">
                        <label for="productCategory">Categoria *</label>
                        <select id="productCategory" required>
                            <option value="">Selecione...</option>
                            <option value="mochilas">Mochilas</option>
                            <option value="canetas">Canetas</option>
                            <option value="cadernos">Cadernos</option>
                            <option value="estojos">Estojos</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="productDescription">Descri√ß√£o</label>
                    <textarea id="productDescription" rows="3" placeholder="Descri√ß√£o breve do produto"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="productPriceOld">Pre√ßo Original (R$) *</label>
                        <input type="number" id="productPriceOld" step="0.01" required placeholder="0.00">
                    </div>

                    <div class="form-group">
                        <label for="productPriceCurrent">Pre√ßo em Oferta (R$) *</label>
                        <input type="number" id="productPriceCurrent" step="0.01" required placeholder="0.00">
                    </div>

                    <div class="form-group">
                        <label for="productDiscount">Desconto (%)</label>
                        <input type="number" id="productDiscount" readonly placeholder="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="productImageFile">Imagem do Produto *</label>
                    <input type="file" id="productImageFile" accept="image/*">
                    <small id="uploadStatus" style="display:block; margin-top:8px; font-weight:600;">
                        üí° Selecione uma imagem para upload autom√°tico
                    </small>
                    <input type="hidden" id="productImage">
                </div>

                <div class="form-group">
                    <label for="productStock">Estoque</label>
                    <input type="number" id="productStock" value="0" placeholder="Quantidade dispon√≠vel">
                </div>

                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="productActive" checked>
                        Produto Ativo (vis√≠vel no site)
                    </label>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-cancel" onclick="closeModal(); return false;">Cancelar</button>
                    <button type="button" id="btnSaveProduct" class="btn-save">üíæ Salvar Produto</button>
                </div>
            </div>
            <!-- FIM da div product-form -->
        </div>
    </div>

    <script src="/js/notifications.js"></script>
    <script src="/js/products.js"></script>
    <script src="/js/load-products-admin.js"></script>
    <script>
        // ‚úÖ DEFINIR API_BASE GLOBAL PARA ADMIN
        window.API_BASE = localStorage.getItem('API_BASE') || 'http://localhost:3333';
        console.log(`üåê API Base configurada: ${window.API_BASE}`);
    </script>
    <script src="/js/admin-produtos.js"></script>
    <script>
        // ‚úÖ PROTE√á√ÉO GLOBAL contra reload e submit
        console.log('‚úÖ [PRODUTOS.HTML] Prote√ß√µes ativadas');
        
        // Bloquear QUALQUER tentativa de submit
        document.addEventListener('submit', function(e) {
            e.preventDefault();
            e.stopPropagation();
            console.error('‚ùå Submit bloqueado!');
            return false;
        }, true);
    </script>
</body>
</html>



